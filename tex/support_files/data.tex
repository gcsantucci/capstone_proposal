
\section{Datasets and Inputs} \label{Data}

I will use 2 sets of data in this project, one for each class to be classified. Both sets are similarly generated using many steps of simulation. The first step is to generate the events using Monte Carlo event generators. The generator used in SK for neutrino interactions is called NEUT \cite{NEUT} and the proton decay generator is a custom code of the collaboration that simply generates a vector of kinematic variables for each particle present in the decay.

Once the events are generated, it is necessary to do the simulation of the detector. This is where we simulate how the particles created in the first step will interact as they travel through the water inside the SK tank. This code is also a custom simulator called skdetsim, which is based on a general package called Geant3 \cite{Geant}. Finally, once all the physics simulation is done, the events need to be reconstructed. SK has 2 main algorithms to perform event reconstruction, APFit and fiTQun. In this study we will use fiTQun, which uses a maximum likelihood method based on different hypotheses for an event to reconstruct the kinematics of all particles present in the event.

After all these steps, we have a data set containing many features for every particle present in the event and a label for proton decay (class 1) simulation or neutrino interaction events (class 0). A pre-selection criteria will be applied in the data before we start the analysis. These cuts are necessary to guarantee that fiTQun will perform well, namely, I will only use events that are fully contained inside the fiducial volume (FCFV) of the tank\footnote{This means that the event started and ended inside the detector and 2 m away from the tank walls, without any activity happening outside.}. Also, we need 1-ring events, which means that at most only one particle is detected at a time. This is because our signal is the mono-energetic muon and the low energy photon. The photon energy is so small that it will not produce enough light to be seen as a Cherenkov ring in the detector, while the muon will be clearly seen. Therefore, we can greatly reduce  the number of background by only looking at events that contain only one particle.

Once this pre-selection is applied we can finally start using ML to optimize our event classification. The different features I plan to use in the analysis are:
\begin{itemize}  
\item  $\ln{\left(\frac{L_{\mu}}{L_{e}}\right)}$: This is the log of the ratio of likelihoods for the electron and muon hypotheses. FiTQun will try to fit the event using the hypothesis that an electron generated the ring and after using a muon, for each fit we have the likelihood of how well the fit explains the data\footnote{Similar to a goodness of fit.}. One can then compare the likelihood of different hypotheses to see which one is more likely.
\item  $\ln{\left(\frac{L_{\mu}}{L_{\pi}}\right)}$: Similarly, one can compare the likelihood of the ring being created by a muon and a charged pion.
\item  $\ln{\left(\frac{L_{\mu}}{L_{\mu\gamma}}\right)}$: And finally, one can compare the likelihood of the event having a single muon present or a low energy photon being also present.
\item $P_{\mu}$: This is the reconstructed momentum\footnote{In high energy physics the unit of energy and momentum used is the electronVolt (eV), such that 1 MeV is 1 million eV.} of the muon.
\item $P_{\gamma}$: The reconstructed momentum of the photon.
\item $\Delta T$: The time difference between the muon ring appearing and the photon, in the hypothesis where both are present in the event. Ideally, for signal events this would have a non-zero time difference between them, since the Kaon travels some time before decaying. For neutrino events, the muon is produced instantaneously, so the time difference should be close to zero.
\item  $\Delta X$: The distance between the muon and the Michel electron\footnote{Michel electron is the electron that comes after the muon decays \cite{Michel}.} vertices. 
\end{itemize}

The proton decay sample generated contains 100,000 events, out of which approximately 30,000 are events where the Kaon decayed to a muon and the low energy photon was present. After applying the pre-selection cuts of only FCFV 1-ring events, the number goes down to about 22,000 events.
The atmospheric neutrino event sample was generated using 500 years of Monte Carlo simulation. This means that we simulated a number of events equivalent to SK running for 500 years without stopping. Neutrino interactions are so rare, that a huge amount of events is necessary to be able to properly estimate the number of events in a low-background search like ours. The total number of neutrino events is on the order of 2.5 million. After applying pre-selection cuts, these number is still very big, so extra reduction is necessary.

Another layer of cuts is then applied to reduce the background further. The selected cuts are loose, such that there is still a high number of signal events while the number of background events is drastically reduced. With this extra layer, signal and background samples have similar numbers of events. The choice of these cuts are also chosen based on a physics prior, we know that the final analysis must have more strict cuts than these. So it will not bias our results if we only use these neutrino background events in the analysis. It is guaranteed that the events that are left out here will never be mistaken as signal events. The definition of pre-selection\footnote{More details of the pre-selection will not be provided here since they are not the main purpose of this study.} cuts is:

\begin{itemize} 
\item $\ln{\left(\frac{L_{\mu}}{L_{e}}\right) > 0}$: Events should look more like muons than electrons.
\item $210 \textrm{ MeV} < P_{\mu} < 270 \textrm{ MeV}$: The muon momentum is known to be about 236 MeV, due to detector limitations, we can not measure momentum with infinite resolution. Therefore a window around the expected momentum is allowed.
\item $P_{\gamma} < 2 \textrm{ MeV}$: The momentum of the photon should be at least 2 MeV. This will get rid of events where no photon is found.
\item $\Delta T > 0 \textrm{ ns}$: The time difference between the muon and the photon should be at least 0 nanoseconds. We know that the muon will come after the photon in our signal, so we get rid of a lot of background that has negative $\Delta T$ values.
\end{itemize}

After applying this filter we are finally ready to begin being analyzed. We still have to prepare the data further before feeding it to some ML algorithm, like standardizing each feature, etc. But this will be done in the final project submission. Our final set of data contains 18652 signal events and 24435 neutrino events.